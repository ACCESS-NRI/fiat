MODULE MPL_ABORT_MOD

USE MPL_DATA_MODULE
USE MPL_MPIF

USE PARKIND1  ,ONLY : JPIM     ,JPRB
USE SDL_MODULE, ONLY : DIS_ABORT

PUBLIC MPL_ABORT

CONTAINS 

SUBROUTINE MPL_ABORT(CDMESSAGE)

IMPLICIT NONE

CHARACTER*(*),INTENT(IN),OPTIONAL :: CDMESSAGE
INTEGER(KIND=JPIM) :: ICOMM

CLOSE(MPL_UNIT)
IF(PRESENT(CDMESSAGE)) THEN
  WRITE(MPL_ERRUNIT,'(2A)') 'MPL_ABORT:',CDMESSAGE
ENDIF
WRITE(MPL_ERRUNIT,'(A,I6)') 'MPL_ABORT CALLED FROM PROCESSOR ',MPL_RANK
ICOMM=MPL_COMM
CALL DIS_ABORT(ICOMM)

END SUBROUTINE MPL_ABORT

END MODULE MPL_ABORT_MOD
